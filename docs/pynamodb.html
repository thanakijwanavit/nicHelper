---

title: pynamodb


keywords: fastai
sidebar: home_sidebar

summary: "special pynamodb attributes"
description: "special pynamodb attributes"
nb_path: "nbs/pynamodb.ipynb"
---
<!--

#################################################
### THIS FILE WAS AUTOGENERATED! DO NOT EDIT! ###
#################################################
# file to edit: nbs/pynamodb.ipynb
# command to build the docs after a change: nbdev_build_docs

-->

<div class="container" id="notebook-container">
        
    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">

</div>
    {% endraw %}

<div class="cell border-box-sizing text_cell rendered"><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<h2 id="Imports">Imports<a class="anchor-link" href="#Imports"> </a></h2>
</div>
</div>
</div>
    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">

</div>
    {% endraw %}

<div class="cell border-box-sizing text_cell rendered"><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<h2 id="Error-classes">Error classes<a class="anchor-link" href="#Error-classes"> </a></h2>
</div>
</div>
</div>
    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">

<div class="output_wrapper">
<div class="output">

<div class="output_area">


<div class="output_markdown rendered_html output_subarea ">
<h2 id="PynamoDBSavingError" class="doc_header"><code>class</code> <code>PynamoDBSavingError</code><a href="https://github.com/thanakijwanavit/nicHelper/tree/master/nicHelper/pynamodb.py#L20" class="source_link" style="float:right">[source]</a></h2><blockquote><p><code>PynamoDBSavingError</code>() :: <code>Exception</code></p>
</blockquote>
<p>Common base class for all non-exit exceptions.</p>

</div>

</div>

</div>
</div>

</div>
    {% endraw %}

    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">

<div class="output_wrapper">
<div class="output">

<div class="output_area">


<div class="output_markdown rendered_html output_subarea ">
<h2 id="PynamoDBSchemaValidationError" class="doc_header"><code>class</code> <code>PynamoDBSchemaValidationError</code><a href="https://github.com/thanakijwanavit/nicHelper/tree/master/nicHelper/pynamodb.py#L22" class="source_link" style="float:right">[source]</a></h2><blockquote><p><code>PynamoDBSchemaValidationError</code>() :: <code>Exception</code></p>
</blockquote>
<p>Common base class for all non-exit exceptions.</p>

</div>

</div>

</div>
</div>

</div>
    {% endraw %}

    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">

</div>
    {% endraw %}

<div class="cell border-box-sizing text_cell rendered"><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<h1 id="SchemaAttribute-class">SchemaAttribute class<a class="anchor-link" href="#SchemaAttribute-class"> </a></h1><p>a class which automatically parse and check data against json schema</p>

</div>
</div>
</div>
    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">

<div class="output_wrapper">
<div class="output">

<div class="output_area">


<div class="output_markdown rendered_html output_subarea ">
<h2 id="SchemaAttribute" class="doc_header"><code>class</code> <code>SchemaAttribute</code><a href="https://github.com/thanakijwanavit/nicHelper/tree/master/nicHelper/pynamodb.py#L26" class="source_link" style="float:right">[source]</a></h2><blockquote><p><code>SchemaAttribute</code>(<strong>*<code>args</code></strong>, <strong>**<code>kwds</code></strong>) :: <code>Attribute</code></p>
</blockquote>
<p>An attribute of a model</p>

</div>

</div>

</div>
</div>

</div>
    {% endraw %}

    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">

</div>
    {% endraw %}

<div class="cell border-box-sizing text_cell rendered"><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<h1 id="Dataclass-Attribute">Dataclass Attribute<a class="anchor-link" href="#Dataclass-Attribute"> </a></h1>
</div>
</div>
</div>
    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">

<div class="output_wrapper">
<div class="output">

<div class="output_area">


<div class="output_markdown rendered_html output_subarea ">
<h2 id="DataclassJsonAttribute" class="doc_header"><code>class</code> <code>DataclassJsonAttribute</code><a href="https://github.com/thanakijwanavit/nicHelper/tree/master/nicHelper/pynamodb.py#L60" class="source_link" style="float:right">[source]</a></h2><blockquote><p><code>DataclassJsonAttribute</code>(<strong>*<code>args</code></strong>, <strong>**<code>kwds</code></strong>) :: <code>Attribute</code></p>
</blockquote>
<p>An attribute of a model</p>

</div>

</div>

</div>
</div>

</div>
    {% endraw %}

    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">

</div>
    {% endraw %}

    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="kn">from</span> <span class="nn">pynamodb.models</span> <span class="kn">import</span> <span class="n">Model</span>
<span class="kn">from</span> <span class="nn">pynamodb.attributes</span> <span class="kn">import</span> <span class="n">NumberAttribute</span>
<span class="kn">from</span> <span class="nn">dataclasses</span> <span class="kn">import</span> <span class="n">dataclass</span>
<span class="kn">from</span> <span class="nn">dataclasses_json</span> <span class="kn">import</span> <span class="n">dataclass_json</span>
<span class="kn">from</span> <span class="nn">nicHelper.dataclassUtil</span> <span class="kn">import</span> <span class="n">enforce_types</span>
<span class="kn">import</span> <span class="nn">pytest</span>

<span class="nd">@enforce_types</span>
<span class="nd">@dataclass_json</span>
<span class="nd">@dataclass</span>
<span class="k">class</span> <span class="nc">Product</span><span class="p">:</span>
  <span class="n">code</span><span class="p">:</span> <span class="nb">str</span>
  <span class="n">id_</span><span class="p">:</span> <span class="nb">int</span>


<span class="k">class</span> <span class="nc">Table</span><span class="p">(</span><span class="n">Model</span><span class="p">):</span>
  <span class="k">class</span> <span class="nc">Meta</span><span class="p">:</span>
    <span class="n">table_name</span><span class="o">=</span><span class="s1">&#39;test-please-delete&#39;</span>
    <span class="n">region_name</span><span class="o">=</span><span class="s1">&#39;ap-southeast-1&#39;</span>
  <span class="n">id_</span><span class="o">=</span> <span class="n">NumberAttribute</span><span class="p">(</span><span class="n">hash_key</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
  <span class="n">product</span> <span class="o">=</span> <span class="n">DataclassJsonAttribute</span><span class="p">(</span><span class="n">customDataClass</span><span class="o">=</span><span class="n">Product</span><span class="p">)</span>
  

<span class="n">Table</span><span class="o">.</span><span class="n">create_table</span><span class="p">(</span><span class="n">billing_mode</span><span class="o">=</span><span class="s1">&#39;PAY_PER_REQUEST&#39;</span><span class="p">)</span>


<span class="n">Table</span><span class="p">(</span><span class="n">id_</span><span class="o">=</span><span class="mi">123</span><span class="p">,</span><span class="n">product</span><span class="o">=</span><span class="p">{</span><span class="s1">&#39;code&#39;</span><span class="p">:</span><span class="s1">&#39;123&#39;</span><span class="p">,</span><span class="s1">&#39;id_&#39;</span><span class="p">:</span><span class="mi">123</span> <span class="p">})</span><span class="o">.</span><span class="n">save</span><span class="p">()</span>

<span class="k">with</span> <span class="n">pytest</span><span class="o">.</span><span class="n">raises</span><span class="p">(</span><span class="ne">TypeError</span><span class="p">):</span>
  <span class="n">Table</span><span class="p">(</span><span class="n">id_</span><span class="o">=</span><span class="mi">123</span><span class="p">,</span><span class="n">product</span><span class="o">=</span><span class="p">{</span><span class="s1">&#39;code&#39;</span><span class="p">:</span><span class="mi">123</span><span class="p">,</span><span class="s1">&#39;id_&#39;</span><span class="p">:</span><span class="mi">123</span> <span class="p">})</span><span class="o">.</span><span class="n">save</span><span class="p">()</span>
  <span class="k">raise</span> <span class="ne">Exception</span><span class="p">(</span><span class="s1">&#39;type error should occur&#39;</span><span class="p">)</span>

<span class="n">Table</span><span class="o">.</span><span class="n">delete_table</span><span class="p">()</span>
</pre></div>

    </div>
</div>
</div>

<div class="output_wrapper">
<div class="output">

<div class="output_area">



<div class="output_text output_subarea output_execute_result">
<pre>{&#39;TableDescription&#39;: {&#39;BillingModeSummary&#39;: {&#39;BillingMode&#39;: &#39;PAY_PER_REQUEST&#39;,
   &#39;LastUpdateToPayPerRequestDateTime&#39;: 1627188940.125},
  &#39;ItemCount&#39;: 0,
  &#39;ProvisionedThroughput&#39;: {&#39;NumberOfDecreasesToday&#39;: 0,
   &#39;ReadCapacityUnits&#39;: 0,
   &#39;WriteCapacityUnits&#39;: 0},
  &#39;TableArn&#39;: &#39;arn:aws:dynamodb:us-east-1:394922924679:table/test-please-delete&#39;,
  &#39;TableId&#39;: &#39;4abd3fd9-1114-470f-9569-b03c005cc3d6&#39;,
  &#39;TableName&#39;: &#39;test-please-delete&#39;,
  &#39;TableSizeBytes&#39;: 0,
  &#39;TableStatus&#39;: &#39;DELETING&#39;,
  &#39;TableThroughputModeSummary&#39;: {&#39;LastUpdateToPayPerRequestDateTime&#39;: 1627188940.125,
   &#39;TableThroughputMode&#39;: &#39;PAY_PER_REQUEST&#39;}}}</pre>
</div>

</div>

</div>
</div>

</div>
    {% endraw %}

<div class="cell border-box-sizing text_cell rendered"><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<h1 id="Supermodel">Supermodel<a class="anchor-link" href="#Supermodel"> </a></h1><p>a class which add some functionalities on top of the standard pynamodb model, it sets id_ as the hash key and gives</p>
<ul>
<li>fromDict functions </li>
<li>repr as a dict</li>
</ul>

</div>
</div>
</div>
    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">

</div>
    {% endraw %}

    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">

<div class="output_wrapper">
<div class="output">

<div class="output_area">


<div class="output_markdown rendered_html output_subarea ">
<h2 id="SuperModel" class="doc_header"><code>class</code> <code>SuperModel</code><a href="https://github.com/thanakijwanavit/nicHelper/tree/master/nicHelper/pynamodb.py#L90" class="source_link" style="float:right">[source]</a></h2><blockquote><p><code>SuperModel</code>(<strong><code>hash_key</code></strong>:<code>Optional</code>[<code>Any</code>]=<em><code>None</code></em>, <strong><code>range_key</code></strong>:<code>Optional</code>[<code>Any</code>]=<em><code>None</code></em>, <strong><code>_user_instantiated</code></strong>:<code>bool</code>=<em><code>True</code></em>, <strong>**<code>attributes</code></strong>:<code>Any</code>) :: <code>Model</code></p>
</blockquote>
<p>Defines a <code>PynamoDB</code> Model</p>
<p>This model is backed by a table in DynamoDB.
You can create the table by with the <code>create_table</code> method.</p>

</div>

</div>

</div>
</div>

</div>
    {% endraw %}

    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">

</div>
    {% endraw %}

<div class="cell border-box-sizing text_cell rendered"><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<h3 id="Test">Test<a class="anchor-link" href="#Test"> </a></h3>
</div>
</div>
</div>
    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">testSchema</span> <span class="o">=</span> <span class="s1">&#39;https://gist.githubusercontent.com/thanakijwanavit/e2720d091ae0cef710a49b57c0c9cd4c/raw/ed2d322eac4900ee0f95b431d0f9067a40f3e0f0/squirrelOpenApiV0.0.3.yaml&#39;</span>
<span class="n">schema</span> <span class="o">=</span> <span class="n">yaml</span><span class="o">.</span><span class="n">load</span><span class="p">(</span><span class="n">requests</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="n">testSchema</span><span class="p">)</span><span class="o">.</span><span class="n">text</span><span class="p">,</span> <span class="n">Loader</span><span class="o">=</span> <span class="n">yaml</span><span class="o">.</span><span class="n">Loader</span><span class="p">)</span>
<span class="n">path</span> <span class="o">=</span> <span class="s1">&#39;components/schemas/Location&#39;</span>
<span class="n">dpath</span><span class="o">.</span><span class="n">util</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="n">schema</span><span class="p">,</span> <span class="n">path</span><span class="p">)</span>
</pre></div>

    </div>
</div>
</div>

<div class="output_wrapper">
<div class="output">

<div class="output_area">



<div class="output_text output_subarea output_execute_result">
<pre>{&#39;type&#39;: &#39;object&#39;,
 &#39;required&#39;: [&#39;id&#39;,
  &#39;type&#39;,
  &#39;street_address&#39;,
  &#39;city&#39;,
  &#39;state&#39;,
  &#39;zip&#39;,
  &#39;capacity&#39;,
  &#39;status&#39;],
 &#39;properties&#39;: {&#39;id&#39;: {&#39;type&#39;: &#39;string&#39;, &#39;format&#39;: &#39;uuid&#39;},
  &#39;type&#39;: {&#39;type&#39;: &#39;string&#39;, &#39;enum&#39;: [&#39;pick up&#39;, &#39;drop off&#39;, &#39;overnight&#39;]},
  &#39;street_address&#39;: {&#39;type&#39;: &#39;string&#39;},
  &#39;city&#39;: {&#39;type&#39;: &#39;string&#39;},
  &#39;state&#39;: {&#39;type&#39;: &#39;string&#39;,
   &#39;pattern&#39;: &#39;^(?:(A[KLRZ]|C[AOT]|D[CE]|FL|GA|HI|I[ADLN]|K[SY]|LA|M[ADEINOST]|N[CDEHJMVY]|O[HKR]|PA|RI|S[CD]|T[NX]|UT|V[AT]|W[AIVY]))$&#39;},
  &#39;zip&#39;: {&#39;type&#39;: &#39;string&#39;, &#39;pattern&#39;: &#39;(^\\d{5}$)|(^\\d{5}-\\d{4}$)&#39;},
  &#39;status&#39;: {&#39;type&#39;: &#39;string&#39;, &#39;enum&#39;: [&#39;open&#39;, &#39;in use&#39;]},
  &#39;created&#39;: {&#39;type&#39;: &#39;string&#39;, &#39;format&#39;: &#39;date-time&#39;},
  &#39;modified&#39;: {&#39;type&#39;: &#39;string&#39;, &#39;format&#39;: &#39;date-time&#39;}}}</pre>
</div>

</div>

</div>
</div>

</div>
    {% endraw %}

<div class="cell border-box-sizing text_cell rendered"><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<h3 id="TestModel">TestModel<a class="anchor-link" href="#TestModel"> </a></h3>
</div>
</div>
</div>
    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">schemaUrl</span> <span class="o">=</span> <span class="s1">&#39;https://raw.githubusercontent.com/thanakijwanavit/villaMasterSchema/master/Product.json&#39;</span>
<span class="kn">from</span> <span class="nn">typing</span> <span class="kn">import</span> <span class="n">Any</span>
<span class="k">class</span> <span class="nc">TestModel</span><span class="p">(</span><span class="n">SuperModel</span><span class="p">):</span>
  <span class="k">class</span> <span class="nc">Meta</span><span class="p">:</span>
    <span class="n">table_name</span><span class="o">=</span><span class="s2">&quot;colab-test-sensitive-column&quot;</span>
    <span class="n">region</span> <span class="o">=</span> <span class="s1">&#39;ap-southeast-1&#39;</span>
  <span class="n">data</span> <span class="o">=</span> <span class="n">SchemaAttribute</span><span class="p">(</span><span class="n">schemaUrl</span> <span class="o">=</span> <span class="n">schemaUrl</span><span class="p">,</span> <span class="n">null</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
  <span class="n">phoneHash</span> <span class="o">=</span> <span class="n">UnicodeAttribute</span><span class="p">(</span><span class="n">hash_key</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
  
    
  <span class="c1"># Overrides</span>
  <span class="k">def</span> <span class="nf">pullOutKeys</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span><span class="o">-&gt;</span><span class="kc">None</span><span class="p">:</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">phoneHash</span> <span class="o">=</span> <span class="nb">str</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">data</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s1">&#39;phoneHash&#39;</span><span class="p">)</span> <span class="ow">or</span> <span class="bp">self</span><span class="o">.</span><span class="n">data</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s1">&#39;iprcode&#39;</span><span class="p">)</span> <span class="ow">or</span> <span class="bp">self</span><span class="o">.</span><span class="n">data</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s1">&#39;id&#39;</span><span class="p">)</span> <span class="p">)</span>

  <span class="nd">@beartype</span>
  <span class="k">def</span> <span class="nf">toDict</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span><span class="o">-&gt;</span><span class="nb">dict</span><span class="p">:</span>
    <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">data</span>
    
  <span class="nd">@classmethod</span>
  <span class="nd">@beartype</span>
  <span class="k">def</span> <span class="nf">fromDict</span><span class="p">(</span><span class="bp">cls</span><span class="p">,</span> <span class="n">inputDict</span><span class="p">:</span><span class="nb">dict</span><span class="p">)</span><span class="o">-&gt;</span><span class="n">Any</span><span class="p">:</span>
    <span class="k">return</span> <span class="bp">cls</span><span class="p">(</span><span class="n">data</span><span class="o">=</span><span class="n">inputDict</span><span class="p">)</span>
    
  <span class="nd">@beartype</span>  
  <span class="k">def</span> <span class="nf">update</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span><span class="n">inputDict</span><span class="p">:</span><span class="nb">dict</span><span class="p">)</span><span class="o">-&gt;</span><span class="kc">None</span><span class="p">:</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">data</span><span class="o">.</span><span class="n">update</span><span class="p">(</span><span class="n">inputDict</span><span class="p">)</span>
</pre></div>

    </div>
</div>
</div>

</div>
    {% endraw %}

    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">d</span> <span class="o">=</span> <span class="n">TestModel</span><span class="p">(</span><span class="s1">&#39;123&#39;</span><span class="p">,</span> <span class="n">data</span><span class="o">=</span><span class="p">{</span><span class="s1">&#39;iprcode&#39;</span><span class="p">:</span> <span class="mi">4</span><span class="p">,</span> <span class="s1">&#39;cprcode&#39;</span><span class="p">:</span> <span class="mi">123</span> <span class="p">,</span> <span class="s1">&#39;oprCode&#39;</span><span class="p">:</span> <span class="s1">&#39;123&#39;</span><span class="p">,</span> <span class="s1">&#39;orderId&#39;</span><span class="p">:</span> <span class="mi">123</span><span class="p">})</span>
<span class="k">assert</span> <span class="n">d</span><span class="o">.</span><span class="n">pullOutKeys</span><span class="p">()</span> <span class="o">==</span> <span class="kc">None</span>
<span class="k">assert</span> <span class="nb">type</span><span class="p">(</span><span class="n">d</span><span class="o">.</span><span class="n">toDict</span><span class="p">())</span> <span class="o">==</span> <span class="nb">dict</span>
<span class="k">assert</span> <span class="n">d</span><span class="o">.</span><span class="n">update</span><span class="p">({</span><span class="s1">&#39;cprcode&#39;</span><span class="p">:</span> <span class="mi">234</span><span class="p">})</span> <span class="o">==</span><span class="kc">None</span>
</pre></div>

    </div>
</div>
</div>

</div>
    {% endraw %}

<div class="cell border-box-sizing text_cell rendered"><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<h3 id="success">success<a class="anchor-link" href="#success"> </a></h3>
</div>
</div>
</div>
    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="kn">from</span> <span class="nn">nicHelper.exception</span> <span class="kn">import</span> <span class="n">errorString</span>
<span class="k">try</span><span class="p">:</span>
  <span class="n">test</span> <span class="o">=</span> <span class="n">TestModel</span><span class="o">.</span><span class="n">fromDict</span><span class="p">({</span><span class="s1">&#39;iprcode&#39;</span><span class="p">:</span> <span class="mi">4</span><span class="p">,</span> <span class="s1">&#39;cprcode&#39;</span><span class="p">:</span> <span class="mi">123</span> <span class="p">,</span> <span class="s1">&#39;oprCode&#39;</span><span class="p">:</span> <span class="s1">&#39;123&#39;</span><span class="p">,</span> <span class="s1">&#39;orderId&#39;</span><span class="p">:</span> <span class="mi">123</span><span class="p">})</span>
  <span class="n">test</span><span class="o">.</span><span class="n">save</span><span class="p">()</span>
<span class="k">except</span> <span class="ne">Exception</span> <span class="k">as</span> <span class="n">e</span><span class="p">:</span>
  <span class="nb">print</span><span class="p">(</span><span class="n">e</span><span class="p">)</span>
  <span class="nb">print</span><span class="p">(</span><span class="n">errorString</span><span class="p">())</span>


<span class="nb">next</span><span class="p">(</span><span class="n">TestModel</span><span class="o">.</span><span class="n">query</span><span class="p">(</span><span class="s1">&#39;1&#39;</span><span class="p">))</span>
</pre></div>

    </div>
</div>
</div>

<div class="output_wrapper">
<div class="output">

<div class="output_area">



<div class="output_text output_subarea output_execute_result">
<pre>{&#34;data&#34;: {&#34;type&#34;: &#34;pick up&#34;, &#34;street_address&#34;: &#34;123&#34;, &#34;id&#34;: &#34;123&#34;, &#34;city&#34;: &#34;sth&#34;, &#34;state&#34;: &#34;CA&#34;, &#34;zip&#34;: &#34;23523&#34;, &#34;capacity&#34;: 5, &#34;status&#34;: &#34;open&#34;}}</pre>
</div>

</div>

</div>
</div>

</div>
    {% endraw %}

    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="nb">next</span><span class="p">(</span><span class="n">TestModel</span><span class="o">.</span><span class="n">query</span><span class="p">(</span><span class="s1">&#39;1&#39;</span><span class="p">))</span>
</pre></div>

    </div>
</div>
</div>

<div class="output_wrapper">
<div class="output">

<div class="output_area">



<div class="output_text output_subarea output_execute_result">
<pre>{&#34;data&#34;: {&#34;type&#34;: &#34;pick up&#34;, &#34;street_address&#34;: &#34;123&#34;, &#34;id&#34;: &#34;123&#34;, &#34;city&#34;: &#34;sth&#34;, &#34;state&#34;: &#34;CA&#34;, &#34;zip&#34;: &#34;23523&#34;, &#34;capacity&#34;: 5, &#34;status&#34;: &#34;open&#34;}}</pre>
</div>

</div>

</div>
</div>

</div>
    {% endraw %}

<div class="cell border-box-sizing text_cell rendered"><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<h3 id="fail">fail<a class="anchor-link" href="#fail"> </a></h3>
</div>
</div>
</div>
    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="k">try</span><span class="p">:</span>
  <span class="n">TestModel</span><span class="p">(</span>
    <span class="n">data</span> <span class="o">=</span> <span class="p">{</span><span class="s1">&#39;iprcode&#39;</span><span class="p">:</span> <span class="s1">&#39;4&#39;</span><span class="p">,</span> <span class="s1">&#39;cprcode&#39;</span><span class="p">:</span> <span class="mi">123</span> <span class="p">,</span> <span class="s1">&#39;oprCode&#39;</span><span class="p">:</span> <span class="s1">&#39;123&#39;</span><span class="p">}</span>
  <span class="p">)</span><span class="o">.</span><span class="n">save</span><span class="p">()</span>
<span class="k">except</span> <span class="ne">Exception</span> <span class="k">as</span> <span class="n">e</span><span class="p">:</span>
  <span class="nb">print</span><span class="p">(</span><span class="n">e</span><span class="p">)</span>



<span class="nb">next</span><span class="p">(</span><span class="n">TestModel</span><span class="o">.</span><span class="n">query</span><span class="p">(</span><span class="s1">&#39;1&#39;</span><span class="p">))</span>
</pre></div>

    </div>
</div>
</div>

<div class="output_wrapper">
<div class="output">

<div class="output_area">

<div class="output_subarea output_stream output_stdout output_text">
<pre>failed validation 
 &#39;4&#39; is not of type &#39;integer&#39;

Failed validating &#39;type&#39; in schema[&#39;properties&#39;][&#39;iprcode&#39;]:
    {&#39;type&#39;: &#39;integer&#39;}

On instance[&#39;iprcode&#39;]:
    &#39;4&#39;
</pre>
</div>
</div>

<div class="output_area">



<div class="output_text output_subarea output_execute_result">
<pre>{&#34;data&#34;: {&#34;type&#34;: &#34;pick up&#34;, &#34;street_address&#34;: &#34;123&#34;, &#34;id&#34;: &#34;123&#34;, &#34;city&#34;: &#34;sth&#34;, &#34;state&#34;: &#34;CA&#34;, &#34;zip&#34;: &#34;23523&#34;, &#34;capacity&#34;: 5, &#34;status&#34;: &#34;open&#34;}}</pre>
</div>

</div>

</div>
</div>

</div>
    {% endraw %}

<div class="cell border-box-sizing text_cell rendered"><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<h3 id="nested">nested<a class="anchor-link" href="#nested"> </a></h3>
</div>
</div>
</div>
    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">schemaUrl</span> <span class="o">=</span> <span class="s1">&#39;https://gist.githubusercontent.com/thanakijwanavit/e2720d091ae0cef710a49b57c0c9cd4c/raw/ed2d322eac4900ee0f95b431d0f9067a40f3e0f0/squirrelOpenApiV0.0.3.yaml&#39;</span>
<span class="n">path</span> <span class="o">=</span> <span class="s1">&#39;/components/schemas/Location&#39;</span>
<span class="k">class</span> <span class="nc">ProductModel</span><span class="p">(</span><span class="n">SuperModel</span><span class="p">):</span>
  <span class="k">class</span> <span class="nc">Meta</span><span class="p">:</span>
    <span class="n">table_name</span><span class="o">=</span><span class="s2">&quot;colab-test-sensitive-column&quot;</span>
    <span class="n">region</span> <span class="o">=</span> <span class="s1">&#39;ap-southeast-1&#39;</span>
  <span class="n">phoneHash</span> <span class="o">=</span> <span class="n">UnicodeAttribute</span><span class="p">(</span><span class="n">hash_key</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
  <span class="n">data</span> <span class="o">=</span> <span class="n">SchemaAttribute</span><span class="p">(</span><span class="n">schemaUrl</span> <span class="o">=</span> <span class="n">schemaUrl</span><span class="p">,</span><span class="n">path</span><span class="o">=</span><span class="n">path</span><span class="p">,</span> <span class="n">null</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
  
  <span class="k">def</span> <span class="nf">pullOutKeys</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">phoneHash</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">data</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s1">&#39;id&#39;</span><span class="p">)</span>

  
<span class="k">def</span> <span class="nf">test_nested</span><span class="p">():</span>
  <span class="n">result</span> <span class="o">=</span> <span class="p">{}</span>
  <span class="k">try</span><span class="p">:</span>
    <span class="n">ProductModel</span><span class="p">(</span>
      <span class="n">data</span> <span class="o">=</span> <span class="p">{</span><span class="s1">&#39;type&#39;</span><span class="p">:</span> <span class="s1">&#39;something invalid&#39;</span><span class="p">,</span> <span class="s1">&#39;street_address&#39;</span><span class="p">:</span> <span class="s1">&#39;123&#39;</span> <span class="p">}</span>
    <span class="p">)</span><span class="o">.</span><span class="n">save</span><span class="p">()</span>
  <span class="k">except</span> <span class="ne">Exception</span> <span class="k">as</span> <span class="n">e</span><span class="p">:</span>
    <span class="nb">print</span><span class="p">(</span><span class="s1">&#39;faulty data is rejected&#39;</span><span class="p">)</span>
    <span class="n">result</span><span class="p">[</span><span class="s1">&#39;errorModel&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="kc">True</span>

  <span class="k">try</span><span class="p">:</span>
    <span class="n">data</span> <span class="o">=</span> <span class="p">{</span><span class="s1">&#39;type&#39;</span><span class="p">:</span> <span class="s1">&#39;pick up&#39;</span><span class="p">,</span> <span class="s1">&#39;street_address&#39;</span><span class="p">:</span> <span class="s1">&#39;123&#39;</span> <span class="p">,</span> <span class="s1">&#39;id&#39;</span><span class="p">:</span> <span class="s1">&#39;123&#39;</span><span class="p">,</span> <span class="s1">&#39;city&#39;</span><span class="p">:</span><span class="s1">&#39;sth&#39;</span><span class="p">,</span> <span class="s1">&#39;state&#39;</span><span class="p">:</span> <span class="s1">&#39;CA&#39;</span><span class="p">,</span> <span class="s1">&#39;zip&#39;</span><span class="p">:</span><span class="s1">&#39;23523&#39;</span><span class="p">,</span> <span class="s1">&#39;capacity&#39;</span><span class="p">:</span><span class="mi">5</span><span class="p">,</span> <span class="s1">&#39;status&#39;</span><span class="p">:</span><span class="s1">&#39;open&#39;</span><span class="p">}</span>
    <span class="n">product</span><span class="p">:</span><span class="n">ProductModel</span> <span class="o">=</span> <span class="n">ProductModel</span><span class="o">.</span><span class="n">fromDict</span><span class="p">(</span><span class="n">data</span><span class="p">)</span>
    <span class="n">result</span><span class="p">[</span><span class="s1">&#39;successModel&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="kc">True</span>
  <span class="k">except</span> <span class="ne">Exception</span> <span class="k">as</span> <span class="n">e</span><span class="p">:</span>
    <span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s1">&#39;valid data is rejected</span><span class="se">\n</span><span class="si">{</span><span class="n">e</span><span class="si">}</span><span class="s1">&#39;</span><span class="p">)</span>
    <span class="n">result</span><span class="p">[</span><span class="s1">&#39;successModel&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="kc">False</span>
  

  <span class="k">assert</span> <span class="nb">next</span><span class="p">(</span><span class="n">TestModel</span><span class="o">.</span><span class="n">query</span><span class="p">(</span><span class="s1">&#39;1&#39;</span><span class="p">))</span><span class="o">.</span><span class="n">data</span> <span class="o">==</span> <span class="p">{</span><span class="s1">&#39;type&#39;</span><span class="p">:</span> <span class="s1">&#39;pick up&#39;</span><span class="p">,</span> <span class="s1">&#39;street_address&#39;</span><span class="p">:</span> <span class="s1">&#39;123&#39;</span> <span class="p">,</span> <span class="s1">&#39;id&#39;</span><span class="p">:</span> <span class="s1">&#39;123&#39;</span><span class="p">,</span> <span class="s1">&#39;city&#39;</span><span class="p">:</span><span class="s1">&#39;sth&#39;</span><span class="p">,</span> <span class="s1">&#39;state&#39;</span><span class="p">:</span> <span class="s1">&#39;CA&#39;</span><span class="p">,</span> <span class="s1">&#39;zip&#39;</span><span class="p">:</span><span class="s1">&#39;23523&#39;</span><span class="p">,</span> <span class="s1">&#39;capacity&#39;</span><span class="p">:</span><span class="mi">5</span><span class="p">,</span> <span class="s1">&#39;status&#39;</span><span class="p">:</span><span class="s1">&#39;open&#39;</span><span class="p">}</span>
  <span class="k">assert</span> <span class="n">result</span><span class="p">[</span><span class="s1">&#39;successModel&#39;</span><span class="p">]</span> <span class="o">==</span> <span class="kc">True</span><span class="p">,</span> <span class="s1">&#39;success model didnt save properly&#39;</span>
  <span class="k">assert</span> <span class="n">result</span><span class="p">[</span><span class="s1">&#39;errorModel&#39;</span><span class="p">]</span> <span class="o">==</span> <span class="kc">True</span><span class="p">,</span> <span class="s1">&#39;error model went through&#39;</span>
  
<span class="n">test_nested</span><span class="p">()</span>
</pre></div>

    </div>
</div>
</div>

<div class="output_wrapper">
<div class="output">

<div class="output_area">

<div class="output_subarea output_stream output_stdout output_text">
<pre>faulty data is rejected
</pre>
</div>
</div>

</div>
</div>

</div>
    {% endraw %}

<div class="cell border-box-sizing text_cell rendered"><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<h1 id="Standard-functions">Standard functions<a class="anchor-link" href="#Standard-functions"> </a></h1>
</div>
</div>
</div>
<div class="cell border-box-sizing text_cell rendered"><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<h2 id="Create-data">Create data<a class="anchor-link" href="#Create-data"> </a></h2>
</div>
</div>
</div>
    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">

<div class="output_wrapper">
<div class="output">

<div class="output_area">


<div class="output_markdown rendered_html output_subarea ">
<h4 id="createData" class="doc_header"><code>createData</code><a href="https://github.com/thanakijwanavit/nicHelper/tree/master/nicHelper/pynamodb.py#L185" class="source_link" style="float:right">[source]</a></h4><blockquote><p><code>createData</code>(<strong><code>event</code></strong>:<code>dict</code>, <strong><code>hashKeyName</code></strong>:<code>str</code>, <strong><code>mainClass</code></strong>:<code>Model</code>, <strong><code>schemaUrl</code></strong>:<code>Optional</code>[<code>str</code>]=<em><code>None</code></em>, <strong><code>schemaFormat</code></strong>:<code>str</code>=<em><code>'yaml'</code></em>, <strong>*<code>args</code></strong>)</p>
</blockquote>
<p>create a new row of data</p>

</div>

</div>

</div>
</div>

</div>
    {% endraw %}

    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">

</div>
    {% endraw %}

<div class="cell border-box-sizing text_cell rendered"><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<h3 id="Usage-example">Usage example<a class="anchor-link" href="#Usage-example"> </a></h3>
</div>
</div>
</div>
    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="k">def</span> <span class="nf">create</span> <span class="p">(</span><span class="n">event</span><span class="p">,</span> <span class="o">*</span><span class="n">args</span><span class="p">):</span>
  <span class="n">body</span> <span class="o">=</span> <span class="n">Event</span><span class="o">.</span><span class="n">parseBody</span><span class="p">(</span><span class="n">event</span><span class="p">)</span>
  <span class="n">body</span><span class="p">[</span><span class="s1">&#39;id&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">body</span><span class="p">[</span><span class="s1">&#39;phoneHash&#39;</span><span class="p">]</span>
  
  <span class="n">event2</span> <span class="o">=</span> <span class="n">Event</span><span class="o">.</span><span class="n">getInput</span><span class="p">(</span><span class="n">body</span><span class="p">)</span>
  <span class="n">r</span> <span class="o">=</span> <span class="n">createData</span><span class="p">(</span><span class="n">event2</span><span class="p">,</span> <span class="n">hashKeyName</span><span class="o">=</span><span class="s1">&#39;phoneHash&#39;</span><span class="p">,</span> <span class="n">mainClass</span><span class="o">=</span><span class="n">TestModel</span><span class="p">)</span>
  <span class="k">if</span> <span class="n">r</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s1">&#39;statusCode&#39;</span><span class="p">)</span> <span class="o">!=</span> <span class="mi">200</span><span class="p">:</span> <span class="k">return</span> <span class="n">r</span>
  <span class="n">r2</span> <span class="o">=</span> <span class="nb">next</span><span class="p">(</span><span class="n">TestModel</span><span class="o">.</span><span class="n">query</span><span class="p">(</span><span class="n">body</span><span class="p">[</span><span class="s1">&#39;phoneHash&#39;</span><span class="p">]),</span> <span class="kc">None</span><span class="p">)</span>
  <span class="k">if</span> <span class="ow">not</span> <span class="n">r2</span><span class="p">:</span> <span class="k">return</span> <span class="n">Response</span><span class="o">.</span><span class="n">returnError</span><span class="p">(</span><span class="s1">&#39;st wrong with saving, saving but didnt go through&#39;</span><span class="p">)</span>
  <span class="k">return</span> <span class="n">Response</span><span class="o">.</span><span class="n">returnSuccess</span><span class="p">(</span><span class="n">r2</span><span class="p">)</span>
</pre></div>

    </div>
</div>
</div>

</div>
    {% endraw %}

<div class="cell border-box-sizing text_cell rendered"><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<h3 id="Test">Test<a class="anchor-link" href="#Test"> </a></h3>
</div>
</div>
</div>
<div class="cell border-box-sizing text_cell rendered"><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<h4 id="Success">Success<a class="anchor-link" href="#Success"> </a></h4>
</div>
</div>
</div>
    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">schemaUrl</span> <span class="o">=</span> <span class="s1">&#39;https://raw.githubusercontent.com/thanakijwanavit/villaMasterSchema/master/Product.json&#39;</span>
<span class="n">data</span> <span class="o">=</span> <span class="p">{</span><span class="s1">&#39;phoneHash&#39;</span><span class="p">:</span> <span class="s1">&#39;123&#39;</span><span class="p">,</span><span class="s1">&#39;iprcode&#39;</span><span class="p">:</span> <span class="mi">4</span><span class="p">,</span> <span class="s1">&#39;cprcode&#39;</span><span class="p">:</span> <span class="mi">123</span> <span class="p">,</span> <span class="s1">&#39;oprCode&#39;</span><span class="p">:</span> <span class="s1">&#39;123&#39;</span><span class="p">}</span>
<span class="n">event</span> <span class="o">=</span> <span class="n">Event</span><span class="o">.</span><span class="n">getInput</span><span class="p">(</span><span class="n">data</span><span class="p">)</span>
<span class="n">item</span> <span class="o">=</span> <span class="nb">next</span><span class="p">(</span><span class="n">TestModel</span><span class="o">.</span><span class="n">queryId</span><span class="p">(</span><span class="s1">&#39;123&#39;</span><span class="p">),</span> <span class="kc">None</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="s1">&#39;existing item is :&#39;</span><span class="p">,</span><span class="n">item</span><span class="p">)</span>
<span class="c1"># delete item if exist</span>
<span class="k">if</span> <span class="n">item</span><span class="p">:</span>
  <span class="nb">print</span><span class="p">(</span><span class="n">item</span><span class="o">.</span><span class="n">delete</span><span class="p">())</span>
<span class="n">create</span><span class="p">(</span><span class="n">event</span><span class="p">)</span>
</pre></div>

    </div>
</div>
</div>

<div class="output_wrapper">
<div class="output">

<div class="output_area">

<div class="output_subarea output_stream output_stdout output_text">
<pre>existing item is : {&#34;lastEdited&#34;: 1627188189.287273, &#34;creationTime&#34;: 1627188189.190346, &#34;data&#34;: {&#34;phoneHash&#34;: &#34;123&#34;, &#34;iprcode&#34;: 5, &#34;cprcode&#34;: 123, &#34;oprCode&#34;: &#34;1234&#34;, &#34;id&#34;: &#34;123&#34;}, &#34;phoneHash&#34;: &#34;123&#34;}
{&#39;ConsumedCapacity&#39;: {&#39;CapacityUnits&#39;: 1.0, &#39;TableName&#39;: &#39;colab-test-sensitive-column&#39;}}
</pre>
</div>
</div>

<div class="output_area">



<div class="output_text output_subarea output_execute_result">
<pre>{&#39;body&#39;: &#39;{&#34;phoneHash&#34;:&#34;123&#34;,&#34;iprcode&#34;:4,&#34;cprcode&#34;:123,&#34;oprCode&#34;:&#34;123&#34;,&#34;id&#34;:&#34;123&#34;}&#39;,
 &#39;statusCode&#39;: 200,
 &#39;headers&#39;: {&#39;Access-Control-Allow-Headers&#39;: &#39;*&#39;,
  &#39;Access-Control-Allow-Origin&#39;: &#39;*&#39;,
  &#39;Access-Control-Allow-Methods&#39;: &#39;*&#39;}}</pre>
</div>

</div>

</div>
</div>

</div>
    {% endraw %}

    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">createData</span><span class="p">(</span><span class="n">Event</span><span class="o">.</span><span class="n">getInput</span><span class="p">(</span><span class="n">data</span><span class="p">),</span> <span class="n">hashKeyName</span><span class="o">=</span><span class="s1">&#39;phoneHash&#39;</span><span class="p">,</span> <span class="n">mainClass</span> <span class="o">=</span><span class="n">TestModel</span><span class="p">)</span>
<span class="nb">next</span><span class="p">(</span><span class="n">TestModel</span><span class="o">.</span><span class="n">query</span><span class="p">(</span><span class="s1">&#39;123&#39;</span><span class="p">))</span>
</pre></div>

    </div>
</div>
</div>

<div class="output_wrapper">
<div class="output">

<div class="output_area">



<div class="output_text output_subarea output_execute_result">
<pre>{&#34;lastEdited&#34;: 1627189085.221547, &#34;creationTime&#34;: 1627189085.22156, &#34;data&#34;: {&#34;phoneHash&#34;: &#34;123&#34;, &#34;iprcode&#34;: 4, &#34;cprcode&#34;: 123, &#34;oprCode&#34;: &#34;123&#34;, &#34;id&#34;: &#34;123&#34;}}</pre>
</div>

</div>

</div>
</div>

</div>
    {% endraw %}

    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">test</span> <span class="o">=</span> <span class="n">TestModel</span><span class="p">(</span><span class="n">data</span> <span class="o">=</span> <span class="n">data</span><span class="p">)</span>
<span class="n">test</span><span class="o">.</span><span class="n">save</span><span class="p">()</span>
<span class="n">test</span><span class="o">.</span><span class="n">phoneHash</span>
<span class="nb">next</span><span class="p">(</span><span class="n">TestModel</span><span class="o">.</span><span class="n">query</span><span class="p">(</span><span class="s1">&#39;123&#39;</span><span class="p">))</span>
</pre></div>

    </div>
</div>
</div>

<div class="output_wrapper">
<div class="output">

<div class="output_area">



<div class="output_text output_subarea output_execute_result">
<pre>{&#34;lastEdited&#34;: 1627189085.631451, &#34;creationTime&#34;: 1627189085.631462, &#34;data&#34;: {&#34;phoneHash&#34;: &#34;123&#34;, &#34;iprcode&#34;: 4, &#34;cprcode&#34;: 123, &#34;oprCode&#34;: &#34;123&#34;}}</pre>
</div>

</div>

</div>
</div>

</div>
    {% endraw %}

<div class="cell border-box-sizing text_cell rendered"><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<h2 id="GetData">GetData<a class="anchor-link" href="#GetData"> </a></h2>
</div>
</div>
</div>
    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">

<div class="output_wrapper">
<div class="output">

<div class="output_area">


<div class="output_markdown rendered_html output_subarea ">
<h4 id="getData" class="doc_header"><code>getData</code><a href="https://github.com/thanakijwanavit/nicHelper/tree/master/nicHelper/pynamodb.py#L225" class="source_link" style="float:right">[source]</a></h4><blockquote><p><code>getData</code>(<strong><code>hashKeyName</code></strong>:<code>str</code>, <strong><code>mainClass</code></strong>:<code>Model</code>)</p>
</blockquote>
<p>create a new basket</p>

</div>

</div>

</div>
</div>

</div>
    {% endraw %}

    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">

</div>
    {% endraw %}

<div class="cell border-box-sizing text_cell rendered"><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<h3 id="usage">usage<a class="anchor-link" href="#usage"> </a></h3>
</div>
</div>
</div>
    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="k">def</span> <span class="nf">lambdaGet</span><span class="p">(</span><span class="n">event</span><span class="p">,</span> <span class="o">*</span><span class="n">args</span><span class="p">):</span>
  <span class="n">query</span> <span class="o">=</span> <span class="n">Event</span><span class="o">.</span><span class="n">parseBody</span><span class="p">(</span><span class="n">event</span><span class="p">)</span>
  <span class="k">if</span> <span class="s1">&#39;key&#39;</span> <span class="ow">not</span> <span class="ow">in</span> <span class="n">query</span><span class="p">:</span> <span class="k">return</span> <span class="n">Response</span><span class="o">.</span><span class="n">returnError</span><span class="p">(</span><span class="sa">f</span><span class="s1">&#39;missing key&#39;</span><span class="p">)</span>
  <span class="k">return</span> <span class="n">getData</span><span class="p">(</span><span class="n">query</span><span class="p">[</span><span class="s1">&#39;key&#39;</span><span class="p">],</span> <span class="n">TestModel</span><span class="p">)</span>
</pre></div>

    </div>
</div>
</div>

</div>
    {% endraw %}

<div class="cell border-box-sizing text_cell rendered"><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<h3 id="Test">Test<a class="anchor-link" href="#Test"> </a></h3>
</div>
</div>
</div>
<div class="cell border-box-sizing text_cell rendered"><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<h4 id="Success">Success<a class="anchor-link" href="#Success"> </a></h4>
</div>
</div>
</div>
    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">data</span> <span class="o">=</span> <span class="p">{</span><span class="s1">&#39;phoneHash&#39;</span><span class="p">:</span> <span class="s1">&#39;123&#39;</span><span class="p">,</span><span class="s1">&#39;iprcode&#39;</span><span class="p">:</span> <span class="mi">4</span><span class="p">,</span> <span class="s1">&#39;cprcode&#39;</span><span class="p">:</span> <span class="mi">123</span> <span class="p">,</span> <span class="s1">&#39;oprCode&#39;</span><span class="p">:</span> <span class="s1">&#39;123&#39;</span><span class="p">}</span>
<span class="n">event</span> <span class="o">=</span> <span class="n">Event</span><span class="o">.</span><span class="n">getInput</span><span class="p">(</span><span class="n">data</span><span class="p">)</span>
<span class="n">create</span><span class="p">(</span><span class="n">event</span><span class="p">)</span>

<span class="n">lambdaGet</span><span class="p">(</span><span class="n">Event</span><span class="o">.</span><span class="n">getInput</span><span class="p">({</span><span class="s1">&#39;key&#39;</span><span class="p">:</span> <span class="s1">&#39;123&#39;</span><span class="p">}))</span>
</pre></div>

    </div>
</div>
</div>

<div class="output_wrapper">
<div class="output">

<div class="output_area">



<div class="output_text output_subarea output_execute_result">
<pre>{&#39;body&#39;: &#39;{&#34;phoneHash&#34;:&#34;123&#34;,&#34;iprcode&#34;:4,&#34;cprcode&#34;:123,&#34;oprCode&#34;:&#34;123&#34;}&#39;,
 &#39;statusCode&#39;: 200,
 &#39;headers&#39;: {&#39;Access-Control-Allow-Headers&#39;: &#39;*&#39;,
  &#39;Access-Control-Allow-Origin&#39;: &#39;*&#39;,
  &#39;Access-Control-Allow-Methods&#39;: &#39;*&#39;}}</pre>
</div>

</div>

</div>
</div>

</div>
    {% endraw %}

<div class="cell border-box-sizing text_cell rendered"><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<h4 id="failed-wrong-key-type">failed wrong key type<a class="anchor-link" href="#failed-wrong-key-type"> </a></h4>
</div>
</div>
</div>
    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">lambdaGet</span><span class="p">(</span><span class="n">Event</span><span class="o">.</span><span class="n">getInput</span><span class="p">({</span><span class="s1">&#39;key&#39;</span><span class="p">:</span> <span class="mi">123</span><span class="p">}))</span>
</pre></div>

    </div>
</div>
</div>

<div class="output_wrapper">
<div class="output">

<div class="output_area">



<div class="output_text output_subarea output_execute_result">
<pre>{&#39;body&#39;: &#39;{&#34;error&#34;:&#34;failed to query with error object of type \&#39;int\&#39; has no len()&#34;}&#39;,
 &#39;statusCode&#39;: 400,
 &#39;headers&#39;: {&#39;Access-Control-Allow-Headers&#39;: &#39;*&#39;,
  &#39;Access-Control-Allow-Origin&#39;: &#39;*&#39;,
  &#39;Access-Control-Allow-Methods&#39;: &#39;*&#39;}}</pre>
</div>

</div>

</div>
</div>

</div>
    {% endraw %}

<div class="cell border-box-sizing text_cell rendered"><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<h2 id="update-data">update data<a class="anchor-link" href="#update-data"> </a></h2>
</div>
</div>
</div>
    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">

<div class="output_wrapper">
<div class="output">

<div class="output_area">


<div class="output_markdown rendered_html output_subarea ">
<h4 id="updateData" class="doc_header"><code>updateData</code><a href="https://github.com/thanakijwanavit/nicHelper/tree/master/nicHelper/pynamodb.py#L241" class="source_link" style="float:right">[source]</a></h4><blockquote><p><code>updateData</code>(<strong><code>event</code></strong>:<code>dict</code>, <strong><code>hashKeyName</code></strong>:<code>str</code>, <strong><code>mainClass</code></strong>:<code>Model</code>, <strong><code>schemaUrl</code></strong>:<code>Optional</code>[<code>str</code>]=<em><code>None</code></em>, <strong><code>schemaFormat</code></strong>:<code>str</code>=<em><code>'yaml'</code></em>, <strong>*<code>args</code></strong>)</p>
</blockquote>
<p>updating data based on the new input</p>
<p>event:dict: object gathered from apiGatewayProxy
hashKeyName:str: the name of the hash key
mainClass:Model: pynamodb model class for this object
schemaUrl:Optional[str]: url of the input schema for validation
schemaFormat:Enum['yaml', 'json']</p>

</div>

</div>

</div>
</div>

</div>
    {% endraw %}

    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">

</div>
    {% endraw %}

<div class="cell border-box-sizing text_cell rendered"><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<h3 id="sample-Usage">sample Usage<a class="anchor-link" href="#sample-Usage"> </a></h3>
</div>
</div>
</div>
    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="k">def</span> <span class="nf">update</span><span class="p">(</span><span class="n">event</span><span class="p">,</span> <span class="o">*</span><span class="n">args</span><span class="p">):</span>
  <span class="n">body</span> <span class="o">=</span> <span class="n">Event</span><span class="o">.</span><span class="n">parseBody</span><span class="p">(</span><span class="n">event</span><span class="p">)</span>
  <span class="n">body</span><span class="p">[</span><span class="s1">&#39;id&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">body</span><span class="p">[</span><span class="s1">&#39;phoneHash&#39;</span><span class="p">]</span>
  
  <span class="n">event2</span> <span class="o">=</span> <span class="n">Event</span><span class="o">.</span><span class="n">getInput</span><span class="p">(</span><span class="n">body</span><span class="p">)</span>
  <span class="n">hashKeyname</span> <span class="o">=</span> <span class="s1">&#39;id&#39;</span>
  <span class="k">return</span> <span class="n">updateData</span><span class="p">(</span><span class="n">event2</span><span class="p">,</span> <span class="n">hashKeyName</span><span class="o">=</span><span class="n">hashKeyname</span><span class="p">,</span> <span class="n">mainClass</span><span class="o">=</span><span class="n">TestModel</span><span class="p">)</span>
</pre></div>

    </div>
</div>
</div>

</div>
    {% endraw %}

    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">r</span> <span class="o">=</span> <span class="n">create</span><span class="p">(</span><span class="n">Event</span><span class="o">.</span><span class="n">getInput</span><span class="p">({</span><span class="s1">&#39;phoneHash&#39;</span><span class="p">:</span> <span class="s1">&#39;123&#39;</span><span class="p">,</span><span class="s1">&#39;iprcode&#39;</span><span class="p">:</span> <span class="mi">5</span><span class="p">,</span> <span class="s1">&#39;cprcode&#39;</span><span class="p">:</span> <span class="mi">123</span> <span class="p">,</span> <span class="s1">&#39;oprCode&#39;</span><span class="p">:</span> <span class="s1">&#39;123&#39;</span><span class="p">}))</span>
<span class="n">r</span> <span class="o">=</span> <span class="n">update</span><span class="p">(</span><span class="n">Event</span><span class="o">.</span><span class="n">getInput</span><span class="p">({</span><span class="s1">&#39;phoneHash&#39;</span><span class="p">:</span> <span class="s1">&#39;123&#39;</span><span class="p">,</span><span class="s1">&#39;iprcode&#39;</span><span class="p">:</span> <span class="mi">5</span><span class="p">,</span> <span class="s1">&#39;cprcode&#39;</span><span class="p">:</span> <span class="mi">123</span> <span class="p">,</span> <span class="s1">&#39;oprCode&#39;</span><span class="p">:</span> <span class="s1">&#39;1234&#39;</span><span class="p">}))</span>
<span class="n">lambdaGet</span><span class="p">(</span><span class="n">Event</span><span class="o">.</span><span class="n">getInput</span><span class="p">({</span><span class="s1">&#39;key&#39;</span><span class="p">:</span><span class="s1">&#39;123&#39;</span><span class="p">}))</span>
</pre></div>

    </div>
</div>
</div>

<div class="output_wrapper">
<div class="output">

<div class="output_area">



<div class="output_text output_subarea output_execute_result">
<pre>{&#39;body&#39;: &#39;{&#34;phoneHash&#34;:&#34;123&#34;,&#34;iprcode&#34;:5,&#34;cprcode&#34;:123,&#34;oprCode&#34;:&#34;1234&#34;,&#34;id&#34;:&#34;123&#34;}&#39;,
 &#39;statusCode&#39;: 200,
 &#39;headers&#39;: {&#39;Access-Control-Allow-Headers&#39;: &#39;*&#39;,
  &#39;Access-Control-Allow-Origin&#39;: &#39;*&#39;,
  &#39;Access-Control-Allow-Methods&#39;: &#39;*&#39;}}</pre>
</div>

</div>

</div>
</div>

</div>
    {% endraw %}

</div>
 

